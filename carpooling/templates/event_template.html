{% extends 'bases/webflow_base.html' %}

{% set title = event.event_name.capitalize() %}
{% set active_page='events' %}

{% block subtitle %}{{event.get_description()}} <br> {{event.get_date()}} {{event.get_times()}}{% endblock %}

{% block main %}

{% for region in regions%}
<div class="regiondiv" style="border-color:{{region.color}}">
    <h3 class="style2">{{region.name.capitalize()}} Region</h3>
    {% for carpool in region.get_carpools_in_event(event) %}
        {% if carpool.has_driver() %}
        <div class="style1">
        <p class="style2"> Ride with <a href= "{{url_for('driver_page', firstname=carpool.driver.first_name, lastname=carpool.driver.last_name )}}"> {{carpool.driver.first_name.capitalize()}} {{carpool.driver.last_name.capitalize()}}</a> </p>
        <ul id="buttons01" class="style1 buttons">
            <li>
        {% for i in range(carpool.num_passengers) %}
            {% if carpool.get_passenger_number_name(i) !='Open' %}
            <a class="closedbutton n01">
                <span class="label"> {{carpool.get_passenger_number_name(i)}} </span>
            </a>
            {% else %}
            <a href="{{ url_for('passenger_carpool_signup_page', carpool_index = carpool.index)}}" class="button n01">
                <span class="label">{{carpool.get_passenger_number_name(i)}} </span>
                </a>
            {% endif %}
        {% endfor %}
            </li>
        </ul>

        <p class = "style2"> Dropoff Location: {{carpool.get_dropoff_location()}} </p>
        </div>

        {% else %}
        <br>
        <br>
        <div class="style1">
            <ul class="style1 buttons">
                <li>
            <a href="{{ url_for('driver_carpool_signup_page', carpool_index = carpool.index)}}" onclick="confirm_valid_driver(event)" class="button n01">
                <span class="label">Drive for this region!</span>
            </a>
                </li>
            </ul>
            
        </div>

        {% endif %}

    {% endfor %}
</div>
{% endfor %}
{% endblock %}

{% block scripts %}
<script>
    function confirm_valid_driver(e) {
        if ("{{user.is_authenticated }}" == "False") {
            e.preventDefault();
            alert("You must be logged in to drive a carpool!");
        }

    }
</script>
{% endblock %}
