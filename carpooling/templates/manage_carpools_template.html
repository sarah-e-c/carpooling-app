<!DOCTYPE html>
<!-- This site was created in Webflow. https://www.webflow.com -->
<!-- Last Published: Wed Oct 05 2022 17:13:44 GMT+0000 (Coordinated Universal Time) -->
<html data-wf-domain="sarahs-dandy-site.webflow.io" data-wf-page="633db6b20fc68522b30e41f4"
    data-wf-site="633db6b20fc685cfcc0e41e2">

<head>
    <meta charset="utf-8" />
    <title>Mech Tech Dragons Events</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta content="Webflow" name="generator" />
    <link href="{{ url_for('static', filename='events_style.css')}}" rel="stylesheet" type="text/css" />
    <link href="{{ url_for('static', filename='carrdstyle.css')}}" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@300&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
    <script type="text/javascript">
        WebFont.load({
            google: {
                families: ["Poppins:100,200,300,regular,500,600,700,800,900", "Playfair Display:regular,italic,700,700italic,900,900italic"]
            }
        });
    </script>
    <!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif]-->
    <script type="text/javascript">
        !function (o, c) {
            var n = c.documentElement,
                t = " w-mod-";
            n.className += t + "js",
                ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch")
        }(window, document);
    </script>
    <link href="https://uploads-ssl.webflow.com/633db6b20fc685cfcc0e41e2/633db6b20fc685264c0e421e_q2.jpg"
        rel="shortcut icon" type="image/x-icon" />
    <link href="https://uploads-ssl.webflow.com/633db6b20fc685cfcc0e41e2/633db6b20fc685d03d0e421d_q.jpg"
        rel="apple-touch-icon" />
    <script type="text/javascript">
        window.__WEBFLOW_CURRENCY_SETTINGS = {
            "currencyCode": "USD",
            "$init": true,
            "symbol": "$",
            "decimal": ".",
            "fractionDigits": 2,
            "group": ",",
            "hideDecimalForWholeNumbers": false
        };
    </script>
</head>

<body class="body">
    <div class="page-content">
        <div class="topnav">
            <a href="{{ url_for('home_page') }}">Home</a>
            <a href="{{ url_for('events_page') }}">Events</a>
            {% if user.is_authenticated %}
            <a class="user-info" href="{{ url_for('user_profile_page', user_id=user.id) }}">{{
                user.first_name.capitalize() }} {{user.last_name.capitalize()}}</a>
            <a class="user-info" onclick="confirm_logout(event)"
                href="{{ url_for('home_page', logout=True) }}">Logout</a>
            {% else %}
            <a class="user-info" href="{{ url_for('login_page') }}">Login</a>
            <a class="user-info" href="{{url_for('generic_register_page')}}">Register/Update</a>
            <a class="user-info" href="{{url_for('login_help_page')}}">Login Help</a>

            {% endif %}
        </div>
    </div>
    <div class="banner">
        <div class="banner-second">
            <div class="container center w-container">
                <div class="align-center">
                    <h1 class="style1">
                        {{ user.first_name.capitalize() }} {{user.last_name.capitalize()}}'s Upcoming Carpools
                        <sup></sup>
                    </h1>
                    <h2 class="style2"> Manage upcoming carpools </h2>
                </div>
            </div>
        </div>
    </div>
    <div class="wf-section">

    </div>
    </div> <!-- TODO make a multiline dialog box-->
    <div class="style1">
        {% if not driver_carpools and not passenger_carpools %}
        <h2 class="style2">You have no upcoming carpools.</h2>
        {% endif %}
        {% if driver_carpools %}
        <h2 class="style2"> Carpools I'm driving for </h2>
        {%endif%}

        {% for carpool in driver_carpools%}
        <div class="regiondiv">
            <h3 class="style2">Carpool for {{carpool.event.event_name}} on {{carpool.event.event_date.strftime('%m/%d/%Y')}}</h3>
            </p>
            <p class="style2">Departing from {{carpool.event.event_location}}
                <br>
            Event Start Time {{carpool.event.event_start_time.strftime('%I:%M %p')}}
            <br>
            Event End Time {{carpool.event.event_end_time.strftime('%I:%M %p')}}
            <br>
            Destination: {{ carpool.destination }}
            </p>
            {% if carpool.passengers %}
            <p class="style2"> Passengers
            <ul class="style2">
                {% for passenger in carpool.passengers %}
                <li><p class="style2"> <a
                        href="{{url_for('passenger_page', firstname=passenger.first_name, lastname=passenger.last_name )}}">
                        {{passenger.first_name.capitalize()}} {{passenger.last_name.capitalize()}} </a>
                    {{passenger.phone_number}}</p></li> 
                {% endfor %}
            </ul>
            </p>
            {% else %}
            <p class="style2">There are no passengers for this carpool.</p>
            {% endif %}

            <div class="style1">
                <ul id="buttons01" class="style1 buttons">
                    <li>
                        <a href="{{url_for('cancel_carpool', carpool_id = carpool.index)}}"
                            onclick="confirm_carpool_delete(event, '{{carpool.index}}')" class="button n01">
                            <span class="label"> Cancel Carpool </span>
                        </a>
                        <a href="{{url_for('manage_carpools_page')}}" onclick="change_carpool_destination(event, '{{carpool.index}}')"
                            class="button n01"> 
                            <span class="label"> Change Destination </span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        {% endfor %}

        {% if passenger_carpools %}
        <h2 class="style2"> Carpools I'm riding in</h2>
        {%endif%}

        {% for carpool in passenger_carpools%}
        <div class="regiondiv">
        <h3 class="style2">Carpool for {{carpool.event.event_name}} on {{carpool.event.event_date.strftime('%m/%d/%Y')}}</h3>
        </p>
        <p class="style2">Departing from {{carpool.event.event_location}}
            <br>
        Event Start Time {{carpool.event.event_start_time.strftime('%I:%M %p')}}
        <br>
        Event End Time {{carpool.event.event_end_time.strftime('%I:%M %p')}}
        <br>
        Destination: {{ carpool.destination }}
        <br>
        Driver: <a
                href="{{url_for('driver_page', firstname=carpool.driver.first_name, lastname=carpool.driver.last_name )}}">
                {{carpool.driver.first_name.capitalize()}} {{carpool.driver.last_name.capitalize()}} </a>:
            {{carpool.driver.phone_number}}</p>
        
        </div>
        <div class="style1">
            <ul id="buttons01" class="style1 buttons">
                <li>
                    <a href="{{url_for('leave_carpool', carpool_id = carpool.index)}}"
                        onclick="confirm_carpool_leave(event, '{{carpool.index}}')" class="button n01">
                        <span class="label"> Leave Carpool </span>
                    </a>
                </li>
            </ul>
        </div>
        {%endfor%}

    </div>
    <!--[if lte IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]-->

    <script>
        function confirm_logout(e) {
            if (!confirm("Are you sure you want to logout?")) {
                e.preventDefault();
            }
        }
        function confirm_carpool_delete(e) {
            if (!confirm("Are you sure that you want to delete this carpool?")) {
                e.preventDefault();
            }
        }
        function change_carpool_destination(e, carpool_index) {
            let new_destination = prompt("Enter new destination for carpool");
            if (new_destination == null) {
                e.preventDefault();
            }
            new_request = new XMLHttpRequest();
            new_request.open("POST", "{{ url_for('change_carpool_destination') }}", true);
            new_request.setRequestHeader("Content-Type", "application/json");
            new_request.setRequestHeader("New-Carpool-Destination", new_destination);
            new_request.setRequestHeader("Carpool-Index", carpool_index);
            new_request.send();
        }

        function confirm_carpool_leave(e, carpool_index) {
            if (!confirm("Are you sure that you want to leave this carpool?")) {
                e.preventDefault();
            }
        }

    </script>
</body>

</html>